language: cpp

matrix:
  include:
    - os: linux
      compiler: gcc
    - os: linux
      compiler: clang
    - os: windows

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-8

script:
  - cd benchmark

  - if [[ "$TRAVIS_OS_NAME" != "windows" && "$CXX" != "clang++" ]]; then export CXX=g++-8 ; fi
  - if [[ "$TRAVIS_OS_NAME" != "windows" ]]; then $CXX benchmark.cpp -std=c++1z -Ofast -march=native -fno-rtti -funroll-loops -obenchmark ; fi

  - if [[ "$TRAVIS_OS_NAME" == "windows" ]]; then export CXX="C:/Program Files (x86)/Microsoft Visual Studio/2017/BuildTools/VC/Tools/MSVC/14.16.27023/bin/Hostx86/x64/cl.exe" ; fi
  - if [[ "$TRAVIS_OS_NAME" == "windows" ]]; then $CXX /DNDEBUG /GR- /GL /Gs- /O2 /fp:fast /fp:except- benchmark.cpp /link /LTCG /INCREMENTAL:NO /OPT:REF ; fi

  - ./benchmark
